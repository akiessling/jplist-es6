(()=>{"use strict";class e{static sort(t,s){return!s||s.length<=0?(t.sort(((t,s)=>e.sortByIndex(t,s))),t):(t.sort(((t,i)=>e.sortHelper(t,i,s,0))),t)}static sortHelper(t,s,i,r){if(!i||i.length<=0||r>=i.length)return 0;let n=0;const o=i[r];if("default"!==o.path)switch(o.dataType){case"number":n=e.sortNumbers(t,s,o.path,o.order);break;case"datetime":n=e.sortDateTime(t,s,o.path,o.order,o.dateTimeFormat);break;default:n=e.sortText(t,s,o.path,o.order,o.ignoreRegex)}else n=e.sortByIndex(t,s);return 0===n&&r+1<i.length&&(n=e.sortHelper(t,s,i,r+1)),n}static sortText(e,t,s="",i="asc",r=""){if(!e||!t)return 0;const n=s?e.querySelector(s):e,o=s?t.querySelector(s):t;if(!n||!o)return 0;let l=n.textContent.trim().toLowerCase(),a=o.textContent.trim().toLowerCase();if(r){const e=new RegExp(r,"ig");l=l.replace(e,"").trim(),a=a.replace(e,"").trim()}return l===a?0:(i||(i="asc"),"".localeCompare?"asc"===i?l.localeCompare(a):a.localeCompare(l):"asc"===i?l>a?1:-1:l<a?1:-1)}static sortNumbers(e,t,s="",i="asc"){if(!e||!t)return 0;const r=s?e.querySelector(s):e,n=s?t.querySelector(s):t;if(!r||!n)return 0;let o=r.textContent.trim().toLowerCase(),l=n.textContent.trim().toLowerCase();return o=parseFloat(o.replace(/[^-0-9.]+/g,"")),l=parseFloat(l.replace(/[^-0-9.]+/g,"")),isNaN(o)||isNaN(l)?isNaN(o)&&isNaN(l)?0:isNaN(o)?1:-1:o===l?0:(i||(i="asc"),"asc"===i?o-l:l-o)}static sortByIndex(e,t){if(!e||!t)return 0;let s=Number(e.jplistIndex),i=Number(t.jplistIndex);return isNaN(s)||isNaN(i)?0:s-i}static get months(){return[["january","jan","jan."],["february","feb","feb."],["march","mar","mar."],["april","apr","apr."],["may"],["june","jun."],["july","jul","jul."],["august","aug","aug."],["september","sep","sep."],["october","oct","oct."],["november","nov","nov."],["december","dec","dec."]]}static sortDateTime(t,s,i="",r="asc",n=""){if(!t||!s)return 0;const o=i?t.querySelector(i):t,l=i?s.querySelector(i):s;if(!o||!l)return 0;let a,d,h=o.textContent.trim().toLowerCase(),c=l.textContent.trim().toLowerCase();return(n=n.trim())?(a=e.getDateFromString(h,n),d=e.getDateFromString(c,n)):(a=new Date(Date.parse(h)),d=new Date(Date.parse(c))),a.getTime()===d.getTime()?0:(r||(r="asc"),"asc"===r?a.getTime()>d.getTime()?1:-1:a.getTime()<d.getTime()?1:-1)}static getDateFromString(t,s){s=(s=(s=(s=(s=s.replace(/\./g,"\\.")).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")).replace(/\[/g,"\\[")).replace(/\]/g,"\\]");let i=e.getDateWildcardValue(s,"{year}",t);i=Number(i)||1900;let r=e.getDateWildcardValue(s,"{day}",t);r=Number(r)||1;let n=e.getDateWildcardValue(s,"{month}",t);n=e.getMonthByWildcard(n),-1===n&&(n=0);let o=e.getDateWildcardValue(s,"{hour}",t);o=Number(o)||0;let l=e.getDateWildcardValue(s,"{min}",t);l=Number(l)||0;let a=e.getDateWildcardValue(s,"{sec}",t);return a=Number(a)||0,new Date(i,n,r,o,l,a)}static getDateWildcardValue(e,t,s){let i=null;const r=e.replace(t,"(.*)").replace(/{year}|{month}|{day}|{hour}|{min}|{sec}/g,".*"),n=new RegExp(r,"g").exec(s);return n&&n.length>1&&(i=n[1]),i}static getMonthByWildcard(t){t=t?t.trim().toLowerCase():"";let s=Number(t);return isNaN(s)?e.months.findIndex((e=>e.find((e=>e.trim()===t)))):s-1<0?-1:s-1}}const t=e,s=class{constructor(e,t,s,i){this.itemsNumber=Number(s)||0,this.itemsPerPage=Number.isInteger(t)?Number(t):this.itemsNumber,0===this.itemsPerPage&&(this.itemsPerPage=s),this.pagesNumber=0===this.itemsPerPage?0:Math.ceil(this.itemsNumber/this.itemsPerPage),this.currentPage=Number(e)||0,this.currentPage>this.pagesNumber-1&&(this.currentPage=0),this.start=this.currentPage*this.itemsPerPage,this.end=this.start+this.itemsPerPage,this.end>this.itemsNumber&&(this.end=this.itemsNumber),this.prevPage=this.currentPage<=0?0:this.currentPage-1,this.nextPage=0===this.pagesNumber?0:this.currentPage>=this.pagesNumber-1?this.pagesNumber-1:this.currentPage+1,this.range=Number(i)||10;const r=Math.ceil((this.range-1)/2);this.rangeStart=this.currentPage-r,this.rangeEnd=Math.min(this.rangeStart+this.range-1,this.pagesNumber-1),this.rangeStart<=0&&(this.rangeStart=0,this.rangeEnd=Math.min(this.range-1,this.pagesNumber-1)),this.rangeEnd>=this.pagesNumber-1&&(this.rangeStart=Math.max(this.pagesNumber-this.range,0),this.rangeEnd=this.pagesNumber-1)}},i=class{constructor(e){e&&(this.element=e,this.element.initialHTML=e.outerHTML,this.type=(e.getAttribute("data-jplist-control")||"").trim().toLowerCase(),this.group=(e.getAttribute("data-group")||"").trim().toLowerCase(),this.name=(e.getAttribute("data-name")||e.getAttribute("name")||"default").trim(),this.id=(e.getAttribute("data-id")||"").trim().toLowerCase(),this.jump=(e.getAttribute("data-jump")||"").trim())}};class r{static getParam(e){if(!e)return null;const t=e.split("=");return t.length<2?null:{key:t[0].trim().toLowerCase(),value:t[1].trim().toLowerCase()}}static getUrlParams(e,t="#"){const s=new Map;if(!e)return s;const i=window.decodeURIComponent(e.replace(t,"")).trim().toLowerCase();if(!i)return s;const n=i.split("&");let o="";for(let e of n){const t=r.getParam(e);if(t)if("group"===t.key)o=t.value,s.has(t.value)||s.set(t.value,[]);else{const e=s.get(o);e&&e.push(t),s.set(o,e)}}return s}}const n=r;class o{static isSupported(e){if("cookies"===e)return!0;try{return e in window&&null!==window[e]}catch(e){return!1}}static set(e,t,s,i=-1){if("cookies"===t){const t=encodeURIComponent(e),s=new Date;-1===(i=Number(i)||-1)?document.cookie=name+"="+t+";path=/;":(s.setMinutes(s.getMinutes()+i),document.cookie=name+"="+t+";path=/; expires="+s.toUTCString())}else o.isSupported(t)&&(window[t][s]=e)}static get(e,t){let s="";if("cookies"===e){const e=document.cookie.split(";");for(let i=0;i<e.length;i++){let r=e[i].substr(0,e[i].indexOf("=")),n=e[i].substr(e[i].indexOf("=")+1);if(r=r.replace(/^\s+|\s+$/g,""),r===t){s=decodeURIComponent(n);break}}}else o.isSupported(e)&&(s=window[e][t]||"");return s}}const l=o;class a{static textFilter(e,t,s="",i="contains",r=""){const n=[];if(!e)return[];if("default"===s)return e;const o=t.replace(new RegExp(r,"ig"),"").toLowerCase().trim();for(let t of e){const e=s?t.querySelectorAll(s):[t];if(!e)continue;let l=!1;for(let t of e){const e=t.textContent.replace(new RegExp(r,"ig"),"").toLowerCase().trim();switch(i){case"startsWith":e.startsWith(o)&&(l=!0);break;case"endsWith":e.endsWith(o)&&(l=!0);break;case"equal":e===o&&(l=!0);break;default:l=o.split(" ").every((function(t){return-1!==e.indexOf(t)}))}if(l)break}l&&n.push(t)}return n}static pathFilter(e,t="",s=!1){const i=[];if(!e)return[];if("default"===t||!t)return e;for(let r of e){const e=r.querySelector(t);(e&&!s||!e&&s)&&i.push(r)}return i}static isNumeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}static rangeFilter(e,t="",s,i,r=s,n=i){const o=[];if(!e)return[];if("default"===t)return e;s=Math.max(s,r),i=Math.min(i,n);for(let r of e){const e=t?r.querySelectorAll(t):[r];if(!e)continue;const n=[];for(let t of e){const e=Number(t.textContent.trim().replace(/[^-0-9.]+/g,""));isNaN(e)||n.push(e)}if(n.length>0){const e=Math.max.apply(Math,n),t=Math.min.apply(Math,n);let l=!0;a.isNumeric(s)&&s>t&&(l=!1),a.isNumeric(i)&&e>i&&(l=!1),l&&o.push(r)}}return o}}const d=a;class h{static apply(e,i,r,n="",o=void 0){if(!i||!r)return;const a=[{options:"pathFilterOptions",name:"pathFilter"},{options:"rangeFilterOptions",name:"rangeFilter"},{options:"textFilterOptions",name:"textFilter"}];for(let[e,l]of r)if(n&&n===e||!n){const n=i.get(e),d=h.collectControlsOptions(n);for(let e of l){let i=e.items.length,o=h.getItemsFragment(e.items);d.sortOptions&&d.sortOptions.length>0&&(t.sort(e.items,d.sortOptions),o=h.getItemsFragment(e.items));let l=e.items;for(let e of a){const t=e.options;if(d[t]){const s=h.splitByLogic(d[t]);l=h.handleFilter(l,s.and,"and",e.name);for(let t in s.or)l=h.handleFilter(l,s.or[t],"or",e.name);i=l.length,o=h.getItemsFragment(l)}}if(d.paginationOptions){const e=new s(d.paginationOptions.currentPage,d.paginationOptions.itemsPerPage,l.length,d.paginationOptions.range);if(n.length>0)for(let t of n)t.setPaginationOptions&&t.setPaginationOptions(e);const t=l.slice(e.start,e.end);i=t.length,o=h.getItemsFragment(t)}e.root.appendChild(o),h.sendStateEvent(d,i,n,r,l)}h.jump(n,o)}e.deepLinking?h.updateDeepLink(h.getDeepLink(i,r),e.hashStart):e.storage&&l.set(h.getDeepLink(i,r),e.storage,e.storageName,e.cookiesExpiration)}static performFilter(e,t,s){switch(s){case"textFilter":return d.textFilter(t,e.text,e.path,e.mode,e.ignoreRegex);case"pathFilter":return d.pathFilter(t,e.path,e.isInverted);case"rangeFilter":return d.rangeFilter(t,e.path,e.from,e.to,e.min,e.max)}return t}static handleFilter(e,t,s,i){if(t.length<=0)return e;if("and"===s)for(let s of t)e=h.performFilter(s,e,i);if("or"===s){let s=new Set;for(let r of t){let t=h.performFilter(r,e,i);s=new Set([...s,...t])}e=Array.from(s)}return e}static splitByLogic(e){const t={and:[],or:{}};for(let s of e){const e=s.or;e?void 0===t.or[e]?t.or[e]=[s]:t.or[e].push(s):t.and.push(s)}return t}static jump(e,t=void 0){if(!t||!t.jump)return;let s=-1;if("top"===t.jump)s=0;else{const e=document.querySelector(t.jump);if(!e)return;const i=e.getBoundingClientRect();if(!e.width&&!e.height&&!e.getClientRects().length)return;const r=document.clientTop||document.body.clientTop||0;(s<0||i.top+window.pageYOffset-r<s)&&(s=i.top+window.pageYOffset-r)}s>=0&&window.scroll(0,s)}static sendStateEvent(e,t,s,i,r){if(!s)return;const n=new CustomEvent("jplist.state");n.jplistState={options:e,itemsNumber:t,groups:i,filtered:r};for(let e of s)for(let t of e.controls)t.element.dispatchEvent(n)}static collectControlsOptions(e){const t={sortOptions:[],paginationOptions:null,textFilterOptions:[],pathFilterOptions:[],rangeFilterOptions:[]};if(!e)return t;for(let s of e)s.getSortOptions&&(t.sortOptions=t.sortOptions.concat(s.getSortOptions())),s.getTextFilterOptions&&(t.textFilterOptions=t.textFilterOptions.concat(s.getTextFilterOptions())),s.getPathFilterOptions&&(t.pathFilterOptions=t.pathFilterOptions.concat(s.getPathFilterOptions())),s.getRangeFilterOptions&&(t.rangeFilterOptions=t.rangeFilterOptions.concat(s.getRangeFilterOptions())),s.getPaginationOptions&&(t.paginationOptions=s.getPaginationOptions());return t}static getItemsFragment(e){const t=document.createDocumentFragment();for(let s of e)t.appendChild(s);return t}static updateDeepLink(e,t="#"){let s=e.replace(t,"").trim();if(s=""===s?t:t+s,window.location.hash!==s){const e=window.location.href.indexOf(t);let i;i=-1===e?window.location.href+s:window.location.href.substring(0,e)+s,"replaceState"in window.history?window.history.replaceState("","",i):window.location.replace(i)}}static getDeepLink(e,t){let s=[];for(let i of t.keys()){const t=e.get(i),r=[];for(let e of t){const t=e.getDeepLink();t&&r.push(t)}r.length>0&&(s.push("group="+i),s=s.concat(r))}return s.join("&")}static findGroups(e){const t=new Map;if(!e)return t;const s=[...e];for(let e of s){const s=e.getAttribute("data-jplist-group");let i=[];t.has(s)&&(i=t.get(s)),i.push({root:e,items:[...e.querySelectorAll("[data-jplist-item]")],fragment:document.createDocumentFragment()}),t.set(s,i)}return t}static findControls(e){if(!e)return[];const t=[],s=e.querySelectorAll("[data-jplist-control]");if(s)for(let e of s){if(!e.getAttribute("data-jplist-control"))continue;const s=new i(e);t.push(s)}return t}static findControlGroups(e){const t=new Map;if(e)for(let s of e){let e=[];t.has(s.group)&&(e=t.get(s.group)),e.push(s),t.set(s.group,e)}return t}static findSameNameControls(e,t){const s=new Map;if(t){let i=null;if(e.deepLinking)i=n.getUrlParams(window.location.hash,e.hashStart);else if(e.storage){const t=l.get(e.storage,e.storageName);i=n.getUrlParams(t,"")}for(let e of t){if(!e.type||!window.jplist.controlTypes.has(e.type))continue;const t=window.jplist.controlTypes.get(e.type);if(t){let r=null;r=s.has(e.name)?s.get(e.name):new t(e.group,e.name,[],i),r.addControl(e),s.set(e.name,r)}}}return s}static splitByGroupAndName(e,t){const s=new Map;if(!t)return s;const i=h.findControls(t),r=h.findControlGroups(i);for(let[t,i]of r){const r=h.findSameNameControls(e,i);let n=[];for(let e of r.values())n.push(e);s.set(t,n)}return s}}const c=h;class u{init(e){this.settings=Object.assign({},{storage:"",storageName:"jplist",cookiesExpiration:-1,deepLinking:!1,hashStart:"#"},e),this.controls=c.splitByGroupAndName(this.settings,document.body),this.elements=document.querySelectorAll("[data-jplist-group]"),this.groups=c.findGroups(this.elements);let t=[...document.querySelectorAll("[data-jplist-item]")];for(let e=0;e<t.length;e++)t[e].jplistIndex=e;this.refresh("")}refresh(e="",t=void 0){c.apply(this.settings,this.controls,this.groups,e,t)}resetControl(e){if(e&&this.controls)for(let[t,s]of this.controls)for(let r of s){let s=r.controls.findIndex((t=>t.element===e));if(s>=0){const e=r.controls[s].element,n=document.createElement("div");n.innerHTML=e.initialHTML;const o=n.firstChild;return void(e.parentNode&&(e.parentNode.replaceChild(o,e),r.controls.splice(s,1),r.addControl(new i(o)),this.refresh(t)))}}}resetControls(e=""){if(this.controls)for(let[e,t]of this.controls)for(let e of t)for(let t of e.controls)t.element&&t.element.initialHTML&&(t.element.outerHTML=t.element.initialHTML);this.controls=c.splitByGroupAndName(this.settings,document.body),this.refresh(e)}resetContent(e){for(let[e,t]of this.groups)for(let e of t){let t=c.getItemsFragment(e.items);e.root.appendChild(t)}e&&e(this.groups),this.elements=document.querySelectorAll("[data-jplist-group]"),this.groups=c.findGroups(this.elements);let t=[...document.querySelectorAll("[data-jplist-item]")];for(let e=0;e<t.length;e++)t[e].jplistIndex=e;this.refresh("")}}const p=class{constructor(e,t,s,i=null){this.group=(e||"").trim().toLowerCase(),this.name=(t||"default").trim(),this.controls=s||[],this.deepLinkParams=[],i&&i.has(this.group)&&(this.deepLinkParams=i.get(this.group)||[])}addControl(e){e&&e.name===this.name&&e.group===this.group&&this.controls.push(e)}getDeepLink(){return""}},m=class extends i{constructor(e){if(super(e),e){this.path=(e.getAttribute("data-path")||"").trim(),this.dataType=(e.getAttribute("data-type")||"text").trim().toLowerCase(),this.order=(e.getAttribute("data-order")||"asc").trim().toLowerCase(),this.regex=e.getAttribute("data-regex")||"",this.dateTimeFormat=(e.getAttribute("data-date-format")||"").trim().toLowerCase(),this.multipleSortsNumber=this.getMultipleSortsNumber(e);for(let t=1;t<=this.multipleSortsNumber;t++)this["path"+t]=(e.getAttribute("data-path-"+t)||"").trim(),this["dataType"+t]=(e.getAttribute("data-type-"+t)||"text").trim().toLowerCase(),this["order"+t]=(e.getAttribute("data-order-"+t)||"asc").trim().toLowerCase(),this["regex"+t]=e.getAttribute("data-regex-"+t)||"",this["dateTimeFormat"+t]=(e.getAttribute("data-date-format-"+t)||"").trim().toLowerCase()}}getMultipleSortsNumber(e){let t=0;for(let s of e.attributes){let e=null;const i=/^data-path-([0-9]+)$/g;for(;e=i.exec(s.nodeName);){const s=Number(e[1]);Number.isInteger(s)&&t++}}return t}getSortOptions(){const e=[];if(this.path){e.push({path:this.path,dataType:this.dataType,order:this.order,ignoreRegex:this.ignoreRegex,dateTimeFormat:this.dateTimeFormat});for(let t=1;t<=this.multipleSortsNumber;t++)e.push({path:this["path"+t],dataType:this["dataType"+t],order:this["order"+t],ignoreRegex:this["ignoreRegex"+t],dateTimeFormat:this["dateTimeFormat"+t]})}return e}isEqualTo(e){let t=!0;const s=["path","dataType","order","regex","dateTimeFormat"];for(let i=0;i<s.length;i++)t=t&&this[s[i]]===e[s[i]];t=t&&this.multipleSortsNumber===e.multipleSortsNumber;for(let i=1;i<=this.multipleSortsNumber;i++)for(let r=0;r<s.length;r++)t=t&&this[s[r]+i]===e[s[r]+i];return t}},g=class extends p{getSortOptions(){let e=[];for(let t of this.controls)e=e.concat(t.getSortOptions());return e}addControl(e){if(e.name!==this.name||e.group!==this.group)return null;const t=new m(e.element);return this.controls.push(t),t}},f=class extends g{},b="jplist-selected",x=class extends g{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.checkboxes=[],this.radios=[]}addControl(e){const t=super.addControl(e);if(t.selected="true"===t.element.getAttribute("data-selected"),t.mode=t.element.getAttribute("data-mode")||"radio",t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}"radio"===t.mode&&(this.radios.push(t),this.handleRadios()),"checkbox"===t.mode&&(this.checkboxes.push(t),this.handleCheckboxes()),t.element.addEventListener("click",(e=>{if(e.preventDefault(),"checkbox"===t.mode&&(t.selected=!t.selected,this.checkboxes.forEach((e=>{e.isEqualTo(t)&&(e.selected=t.selected)})),this.handleCheckboxes()),"radio"===t.mode){for(let e of this.radios)e.selected=!1;t.selected=!0,this.handleRadios()}window.jplist&&window.jplist.refresh(this.group,t)}))}handleCheckboxes(){for(let e of this.checkboxes)e.selected?e.element.classList.add(b):e.element.classList.remove(b)}getLastSelectedRadio(){let e=null;for(let t of this.radios)t.selected&&(e=t);return e}handleRadios(){if(this.radios.length>0){let e=this.getLastSelectedRadio();for(let e of this.radios)e.selected=!1,e.element.classList.remove(b);e&&this.radios.forEach((t=>{t.isEqualTo(e)&&(t.selected=!0,t.element.checked=!0,t.element.classList.add(b))}))}}getSortOptions(){let e=[],t=!1;for(let s of this.checkboxes)s.selected?e=e.concat(s.getSortOptions()):t=!0;t&&(e=e.concat([{path:"default"}]));let s=this.getLastSelectedRadio();return s&&(e=e.concat(s.getSortOptions())),e}getDeepLink(){const e=this.checkboxes.map((e=>e.id&&e.selected?e.id+"=1":"")).filter((e=>""!==e)),t=this.radios.map((e=>e.id&&e.selected?e.id+"=1":"")).filter((e=>""!==e)),s=e.concat(t);return Array.from(new Set(s)).join("&")}},w="jplist-selected",C=class extends g{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.radios=[]}addControl(e){const t=super.addControl(e);if(t.selected=t.element.checked,t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}this.radios.push(t),this.handleRadios(),t.element.addEventListener("change",(e=>{e.preventDefault();for(let e of this.radios)e.selected=!1;t.selected=!0,this.handleRadios(),window.jplist&&window.jplist.refresh(this.group,t)}))}getLastSelectedRadio(){let e=null;for(let t of this.radios)t.selected&&(e=t);return e}handleRadios(){if(this.radios.length>0){let e=this.getLastSelectedRadio();for(let e of this.radios)e.selected=!1,e.element.classList.remove(w);e&&this.radios.forEach((t=>{t.isEqualTo(e)&&(t.selected=!0,t.element.checked=!0,t.element.classList.add(w))}))}}getSortOptions(){let e=[],t=this.getLastSelectedRadio();return t&&(e=e.concat(t.getSortOptions())),e}getDeepLink(){const e=this.radios.map((e=>e.id&&e.selected?e.id+"=1":"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}},v="jplist-selected",y=class extends g{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.checkboxes=[]}addControl(e){const t=super.addControl(e);if(t.selected=t.element.checked,t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}this.checkboxes.push(t),this.handleCheckboxes(),t.element.addEventListener("change",(e=>{e.preventDefault(),t.selected=!t.selected,this.checkboxes.forEach((e=>{e.isEqualTo(t)&&(e.selected=t.selected)})),this.handleCheckboxes(),window.jplist&&window.jplist.refresh(this.group,t)}))}handleCheckboxes(){for(let e of this.checkboxes)e.selected?e.element.classList.add(v):e.element.classList.remove(v),e.element.checked=e.selected}getSortOptions(){let e=[],t=!1;for(let s of this.checkboxes)s.selected?e=e.concat(s.getSortOptions()):t=!0;return t&&(e=e.concat([{path:"default"}])),e}getDeepLink(){const e=this.checkboxes.map((e=>e.id?e.selected?e.id+"=1":e.id+"=0":"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}},L=class extends g{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.options=[],this.selected="",this.id=""}addControl(e){const t=super.addControl(e);let s=t.element.querySelectorAll("option");for(let e of s)e.setAttribute("data-name",this.name),e.setAttribute("data-group",this.group),this.options.find((t=>t.element.value===e.value))||this.options.push(new m(e));if(this.selected=t.element.value,t.id){this.id=t.id;const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.element.value=e.value,this.selected=e.value)}t.element.addEventListener("change",(e=>{e.preventDefault(),this.selected=e.target.value;for(let e of this.controls)e.element.value=this.selected;window.jplist&&window.jplist.refresh(this.group,t)}))}getSortOptions(){let e=this.options.find((e=>e.element.value===this.selected));return e?e.getSortOptions():[]}getDeepLink(){let e=this.options.find((e=>e.element.value===this.selected));return this.id?this.id+"="+e.element.value:""}},P=class{constructor(e){if(e){if(this.element=e,!this.element)return;this.panels=this.element.querySelectorAll('[data-type="panel"]'),this.element.openedClass=(this.element.getAttribute("data-opened-class")||"jplist-dd-opened").trim();for(let t of this.panels)t.initialContent=t.innerHTML,t.element=e;this.contents=this.element.querySelectorAll('[data-type="content"]'),this.handlePanelsClick()}}handlePanelsClick(){if(this.panels&&!(this.panels.length<=0)){for(let e of this.panels)e.addEventListener("click",(t=>{let s=!1;for(let t of this.contents)t.classList.toggle(e.element.openedClass),t.classList.contains(e.element.openedClass)&&(s=!0);s?(e.classList.add(e.element.openedClass),e.element.classList.add(e.element.openedClass)):(e.classList.remove(e.element.openedClass),e.element.classList.remove(e.element.openedClass))}));document.addEventListener("click",(e=>{this.element.contains(e.target)||this.close()}))}}setPanelsContent(e){for(let t of this.panels)t.innerHTML=e}restorePanelsContent(){for(let e of this.panels)e.initialContent&&(e.innerHTML=e.initialContent)}close(){for(let e of this.contents)e.classList.remove(this.panels[0].element.openedClass);for(let e of this.panels)e.classList.remove(e.element.openedClass),e.element.classList.remove(e.element.openedClass)}};class k extends g{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.selected=null,this.id=""}addControl(e){const t=super.addControl(e);t.dropdown=new P(e.element),t.buttons=[];let s=t.element.querySelectorAll("[data-path]");for(let e of s){e.setAttribute("data-name",this.name),e.setAttribute("data-group",this.group),e.setAttribute("data-jump",t.jump);let s=new m(e);t.buttons.push(s),s.element.addEventListener("click",(e=>{e.preventDefault(),this.selected=s,this.setSelectedButton(t);for(let e of this.controls)e.dropdown&&e.dropdown.close();window.jplist&&window.jplist.refresh(this.group,s)}))}if(this.selected=k.getSelectedButton(t.buttons),this.setSelectedButton(t),t.id){this.id=t.id;const e=this.deepLinkParams.find((e=>e.key===t.id));if(e){const s=t.buttons.find((t=>{const s=t.element.getAttribute("data-value");return e.value===s?t:null}));s&&(this.selected=s,this.setSelectedButton(t))}}}getSortOptions(){return this.selected?this.selected.getSortOptions():[]}getDeepLink(){return this.id&&this.selected&&this.id+"="+this.selected.element.getAttribute("data-value")||""}static getSelectedButton(e){if(e.length<=0)return null;for(let t of e)if("true"===t.element.getAttribute("data-selected"))return t;return e[0]}setSelectedButton(e){for(let t of this.controls){if(!t.dropdown)continue;const s=e.buttons.find((e=>this.selected.isEqualTo(e)));s&&t.dropdown.setPanelsContent(s.element.textContent)}}}const S=k,N=class extends i{constructor(e){super(e),e&&(this.itemsPerPage=Number(e.getAttribute("data-items-per-page"))||10,this.currentPage=Number(e.getAttribute("data-current-page"))||0,this.range=Number(e.getAttribute("data-range"))||10,this.disabledClass=(e.getAttribute("data-disabled-class")||"jplist-disabled").trim(),this.selectedClass=(e.getAttribute("data-selected-class")||"jplist-selected").trim())}getPaginationOptions(){return{itemsPerPage:this.itemsPerPage,currentPage:this.currentPage,range:this.range}}},A=class extends p{getPaginationOptions(){return this.controls.length>0?this.controls[this.controls.length-1].getPaginationOptions():null}setPaginationOptions(e){}addControl(e){if(e.name!==this.name||e.group!==this.group)return null;const t=new N(e.element);return this.controls.push(t),t}};class j extends A{constructor(e,t,s=[],i=null){super(e,t,s,i),this.currentPage=0,this.itemsPerPage=0,this.range=0,this.id=""}addControl(e){const t=super.addControl(e);if(this.currentPage=t.currentPage,this.itemsPerPage=Number(t.itemsPerPage)||0,this.range=t.range,this.restoreFromDeepLink(t),t.pageButtonsHolder=t.element.querySelector('[data-type="pages"]'),t.pageButtonsHolder&&(t.btnTemplate=t.pageButtonsHolder.innerHTML),t.firstButtons=t.element.querySelectorAll('[data-type="first"]'),t.lastButtons=t.element.querySelectorAll('[data-type="last"]'),t.prevButtons=t.element.querySelectorAll('[data-type="prev"]'),t.nextButtons=t.element.querySelectorAll('[data-type="next"]'),j.bindEventHandler(t.firstButtons,"click",this.pageButtonClick.bind(this),t),j.bindEventHandler(t.lastButtons,"click",this.pageButtonClick.bind(this),t),j.bindEventHandler(t.prevButtons,"click",this.pageButtonClick.bind(this),t),j.bindEventHandler(t.nextButtons,"click",this.pageButtonClick.bind(this),t),t.itemsPerPageSelects=Array.from(t.element.querySelectorAll('[data-type="items-per-page"]')),this.updateItemsPerPageSelect(t.itemsPerPageSelects),t.itemsPerPageDD=Array.from(t.element.querySelectorAll('[data-type="items-per-page-dd"]')),this.initCustomDropdowns(t),j.bindEventHandler(t.itemsPerPageSelects,"change",this.selectChange.bind(this),t),t.labels=t.element.querySelectorAll('[data-type="info"]'),t.labels)for(let e of t.labels)e.template=e.innerHTML}updateItemsPerPageSelect(e){for(let t of e){const e=Array.from(t.options).find((e=>e.value===this.itemsPerPage.toString()));t.value=e&&Number(this.itemsPerPage)||0}}initCustomDropdowns(e){const t=e.itemsPerPageDD;if(t&&!(t.length<=0)){for(let s of t){s.dropdown=new P(s),s.buttons=Array.from(s.querySelectorAll("[data-value]"));for(let t of s.buttons)t.addEventListener("click",(i=>{i.preventDefault(),this.itemsPerPage=Number(t.getAttribute("data-value"))||0,this.setSelectedButton(),s.dropdown.close(),window.jplist&&window.jplist.refresh(this.group,e)}))}this.setSelectedButton()}}setSelectedButton(){for(let e of this.controls)if(e.itemsPerPageDD)for(let t of e.itemsPerPageDD){if(!t.buttons)continue;let e=t.buttons.find((e=>(Number(e.getAttribute("data-value"))||0)===this.itemsPerPage));e||(e=t.buttons.find((e=>0===(Number(e.getAttribute("data-value"))||0)))),e&&t.dropdown.setPanelsContent(e.textContent)}}getPaginationOptions(){return{itemsPerPage:this.itemsPerPage,currentPage:this.currentPage,range:this.range}}setPaginationOptions(e){if(e){this.currentPage=e.currentPage,this.itemsPerPage=e.itemsPerPage;for(let t of this.controls){if(!t.btnTemplate||!t.pageButtonsHolder)continue;for(;t.pageButtonsHolder.firstChild;)t.pageButtonsHolder.removeChild(t.pageButtonsHolder.firstChild);for(let s=e.rangeStart;s<=e.rangeEnd;s++){const e=document.createElement("div");e.innerHTML=t.btnTemplate.replace(new RegExp("{pageNumber}","g"),s+1).trim();const i=e.firstChild;let r=i.querySelector('[data-type="page"]');r||(r=i),r.setAttribute("data-page",s.toString()),s===this.currentPage&&(r.classList.add(t.selectedClass),r.setAttribute("data-selected","true")),r.addEventListener("click",(e=>{this.pageButtonClick(e,r,t)})),t.pageButtonsHolder.appendChild(i)}j.setPageAttr(t.firstButtons,0,0!==this.currentPage,t.disabledClass),j.setPageAttr(t.lastButtons,e.pagesNumber-1,this.currentPage!==e.pagesNumber-1,t.disabledClass),j.setPageAttr(t.prevButtons,e.prevPage,0!==this.currentPage,t.disabledClass),j.setPageAttr(t.nextButtons,e.nextPage,this.currentPage!==e.pagesNumber-1,t.disabledClass);const s=[{key:"{pageNumber}",value:e.currentPage+1},{key:"{pagesNumber}",value:e.pagesNumber},{key:"{startItem}",value:e.start+1},{key:"{endItem}",value:e.end},{key:"{itemsNumber}",value:e.itemsNumber}];if(t.labels)for(let e of t.labels){if(!e.template)continue;let t=e.template;for(let e of s)t=t.replace(new RegExp(e.key,"g"),e.value);e.innerHTML=t}const i=Array.from(t.element.classList).filter((e=>e.startsWith("jplist-pages-number-")||e.startsWith("jplist-items-number-")));for(let e of i)t.element.classList.remove(e);t.element.classList.add("jplist-pages-number-"+e.pagesNumber),t.element.classList.add("jplist-items-number-"+e.itemsNumber)}}}pageButtonClick(e,t,s){e&&e.preventDefault();const i=t?t.getAttribute("data-page"):e.target.getAttribute("data-page");this.currentPage=Number(i)||0,window.jplist&&window.jplist.refresh(this.group,s)}selectChange(e,t,s){e.preventDefault();const i=Number(e.target.value);if(!isNaN(i)){this.itemsPerPage=i;for(let e of this.controls)this.updateItemsPerPageSelect(e.itemsPerPageSelects)}window.jplist&&window.jplist.refresh(this.group,s)}restoreFromDeepLink(e){if(e.id){this.id=e.id;const t=this.deepLinkParams.find((t=>t.key===e.id));if(t){const e=t.value.split("-");if(2!==e.length)return;const s=Number(e[0]),i=Number(e[1]);if(isNaN(s)||isNaN(i))return;this.currentPage=s,this.itemsPerPage=i}}}getDeepLink(){return this.id?this.id+"="+this.currentPage+"-"+this.itemsPerPage:""}static setPageAttr(e,t,s,i){if(e)for(let r of e)r.setAttribute("data-page",t),s?r.classList.remove(i):r.classList.add(i)}static bindEventHandler(e,t,s,i){if(e)for(let r of e)r.addEventListener(t,(e=>{s(e,r,i)}))}}const E=j,F=class extends i{constructor(e){super(e),e&&(this.path=(e.getAttribute("data-path")||"").trim(),this.initialText=e.getAttribute("data-text")||e.value||"",this._text=(e.getAttribute("data-text")||e.value||"").trim(),this.mode=(e.getAttribute("data-mode")||"contains").trim(),this.regex=e.getAttribute("data-regex")||"",this.or=e.getAttribute("data-or")||null)}set text(e){this.initialText=e||"",this._text=(e||"").trim()}get text(){return this._text}getTextFilterOptions(){return{path:this.path,text:this.text,mode:this.mode,ignoreRegex:this.regex,or:this.or}}isEqualTo(e,t=!0){let s=this.path===e.path&&this.mode===e.mode&&this.regex===e.regex;return t&&(s=s&&this.text===e.text),s}},O=class extends p{getTextFilterOptions(){let e=[];for(let t of this.controls)e=e.concat(t.getTextFilterOptions());return e}addControl(e){if(e.name!==this.name||e.group!==this.group)return null;const t=new F(e.element);return this.controls.push(t),t}getDeepLink(){const e=this.controls.map((e=>e.id&&""!==e.text.trim()?e.id+"="+e.text.trim():"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}},T=class extends O{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t}addControl(e){const t=super.addControl(e);if(t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.text=e.value,t.element.value=e.value)}if(t.element.addEventListener("keyup",(e=>{e.preventDefault(),t.text=e.target.value,this.textChanged(t)})),t.clearButtonID=(t.element.getAttribute("data-clear-btn-id")||"").trim(),t.clearButtonID){const e=document.getElementById(t.clearButtonID);e&&e.addEventListener("click",(e=>{e.preventDefault(),t.text="",this.textChanged(t)}))}}textChanged(e){this.controls.forEach((t=>{t.isEqualTo(e,!1)&&(t.element.value=e.initialText,t.text=e.initialText)})),window.jplist&&window.jplist.refresh(this.group,e)}},D="jplist-selected",B=e=>class extends e{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.checkboxes=[]}addControl(e){const t=super.addControl(e);if(t.selected=t.element.checked,t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}this.checkboxes.push(t),this.handleCheckboxes(),t.element.addEventListener("change",(e=>{e.preventDefault(),t.selected=!t.selected,this.checkboxes.forEach((e=>{e.isEqualTo(t)&&(e.selected=t.selected)})),this.handleCheckboxes(),window.jplist&&window.jplist.refresh(this.group,t)}))}handleCheckboxes(){for(let e of this.checkboxes)e.selected?e.element.classList.add(D):e.element.classList.remove(D),e.element.checked=e.selected}getDeepLink(){const e=this.checkboxes.map((e=>e.id?e.selected?e.id+"=1":e.id+"=0":"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}};class R extends(B(O)){getTextFilterOptions(){let e=[];for(let t of this.checkboxes)t.selected&&(e=e.concat(t.getTextFilterOptions()));return e}}const q=R,M="jplist-selected",I=e=>class extends e{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.radios=[]}addControl(e){const t=super.addControl(e);if(t.selected=t.element.checked,t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}this.radios.push(t),this.handleRadios(),t.element.addEventListener("change",(e=>{e.preventDefault();for(let e of this.radios)e.selected=!1;t.selected=!0,this.handleRadios(),window.jplist&&window.jplist.refresh(this.group,t)}))}getLastSelectedRadio(){let e=null;for(let t of this.radios)t.selected&&(e=t);return e}handleRadios(){if(this.radios.length>0){let e=this.getLastSelectedRadio();for(let e of this.radios)e.selected=!1,e.element.classList.remove(M);e&&this.radios.forEach((t=>{t.isEqualTo(e)&&(t.selected=!0,t.element.checked=!0,t.element.classList.add(M))}))}}getDeepLink(){const e=this.radios.map((e=>e.id&&e.selected?e.id+"=1":"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}};class H extends(I(O)){getTextFilterOptions(){let e=[],t=this.getLastSelectedRadio();return t&&(e=e.concat(t.getTextFilterOptions())),e}}const V=H,W="jplist-selected",G=e=>class extends e{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.checkboxes=[],this.radios=[]}addControl(e){const t=super.addControl(e);if(t.selected="true"===t.element.getAttribute("data-selected"),t.mode=t.element.getAttribute("data-mode")||"radio",t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.selected="1"===e.value)}"radio"===t.mode&&(this.radios.push(t),this.handleRadios()),"checkbox"===t.mode&&(this.checkboxes.push(t),this.handleCheckboxes()),t.element.addEventListener("click",(e=>{if(e.preventDefault(),"checkbox"===t.mode&&(t.selected=!t.selected,this.checkboxes.forEach((e=>{e.isEqualTo(t)&&(e.selected=t.selected)})),this.handleCheckboxes()),"radio"===t.mode){for(let e of this.radios)e.selected=!1;t.selected=!0,this.handleRadios()}window.jplist&&window.jplist.refresh(this.group,t)}))}handleCheckboxes(){for(let e of this.checkboxes)e.selected?e.element.classList.add(W):e.element.classList.remove(W),e.element.checked=e.selected}getLastSelectedRadio(){let e=null;for(let t of this.radios)t.selected&&(e=t);return e}handleRadios(){if(this.radios.length>0){let e=this.getLastSelectedRadio();for(let e of this.radios)e.selected=!1,e.element.classList.remove(W);e&&this.radios.forEach((t=>{t.isEqualTo(e)&&(t.selected=!0,t.element.checked=!0,t.element.classList.add(W))}))}}getDeepLink(){const e=this.checkboxes.map((e=>e.id?e.selected?e.id+"=1":e.id+"=0":"")).filter((e=>""!==e)),t=this.radios.map((e=>e.id&&e.selected?e.id+"=1":"")).filter((e=>""!==e)),s=e.concat(t);return Array.from(new Set(s)).join("&")}};class z extends(G(O)){getTextFilterOptions(){let e=[],t=this.getLastSelectedRadio();t&&(e=e.concat(t.getTextFilterOptions()));for(let t of this.checkboxes)t.selected&&(e=e.concat(t.getTextFilterOptions()));return e}}const U=z,_=class extends i{constructor(e){super(e),e&&(this.path=(e.getAttribute("data-path")||"").trim(),this.isInverted="true"===(e.getAttribute("data-inverted")||"").toLowerCase().trim(),this.or=e.getAttribute("data-or")||null)}getPathFilterOptions(){return{path:this.path,isInverted:this.isInverted,or:this.or}}isEqualTo(e){return this.path===e.path&&this.isInverted===e.isInverted}},Y=class extends p{addControl(e){if(e.name!==this.name||e.group!==this.group)return null;const t=new _(e.element);return this.controls.push(t),t}getPathFilterOptions(){let e=[];for(let t of this.controls)e=e.concat(t.getPathFilterOptions());return e}},X=class extends Y{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.options=[],this.selected="",this.id=""}addControl(e){const t=super.addControl(e);let s=t.element.querySelectorAll("option");for(let e of s)e.setAttribute("data-name",this.name),e.setAttribute("data-group",this.group),this.options.find((t=>t.element.value===e.value))||this.options.push(new _(e));if(this.selected=t.element.value,t.id){this.id=t.id;const e=this.deepLinkParams.find((e=>e.key===t.id));e&&(t.element.value=e.value,this.selected=e.value)}t.element.addEventListener("change",(e=>{e.preventDefault(),this.selected=e.target.value;for(let e of this.controls)e.element.value=this.selected;window.jplist&&window.jplist.refresh(this.group,t)}))}getPathFilterOptions(){let e=this.options.find((e=>e.element.value===this.selected));return e?[e.getPathFilterOptions()]:[]}getDeepLink(){let e=this.options.find((e=>e.element.value===this.selected));return this.id?this.id+"="+e.element.value:""}};class Z extends(B(Y)){getPathFilterOptions(){let e=[];for(let t of this.checkboxes)t.selected&&(e=e.concat(t.getPathFilterOptions()));return e}}const $=Z;class J extends(I(Y)){getPathFilterOptions(){let e=[],t=this.getLastSelectedRadio();return t&&(e=e.concat(t.getPathFilterOptions())),e}}const K=J;class Q extends(G(Y)){getPathFilterOptions(){let e=[],t=this.getLastSelectedRadio();t&&(e=e.concat(t.getPathFilterOptions()));for(let t of this.checkboxes)t.selected&&(e=e.concat(t.getPathFilterOptions()));return e}}const ee=Q;class te extends Y{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.selected="",this.id=""}addControl(e){const t=super.addControl(e);t.dropdown=new P(e.element),t.buttons=[];let s=t.element.querySelectorAll("[data-path]");for(let e of s){e.setAttribute("data-name",this.name),e.setAttribute("data-group",this.group),e.setAttribute("data-jump",t.jump);let s=new _(e);t.buttons.push(s),s.element.addEventListener("click",(e=>{e.preventDefault(),this.selected=s,this.setSelectedButton(t),window.jplist&&window.jplist.refresh(this.group,s)}))}if(this.selected=te.getSelectedButton(t.buttons),this.setSelectedButton(t),t.id){this.id=t.id;const e=this.deepLinkParams.find((e=>e.key===t.id));if(e){const s=t.buttons.find((t=>{const s=t.element.getAttribute("data-value");return e.value===s?t:null}));s&&(this.selected=s,this.setSelectedButton(t))}}}getPathFilterOptions(){return this.selected?[this.selected.getPathFilterOptions()]:[]}getDeepLink(){return this.id&&this.selected&&this.id+"="+this.selected.element.getAttribute("data-value")||""}static getSelectedButton(e){if(e.length<=0)return null;for(let t of e)if("true"===t.element.getAttribute("data-selected"))return t;return e[0]}setSelectedButton(e){for(let t of this.controls){if(!t.dropdown)continue;const s=e.buttons.find((e=>this.selected.isEqualTo(e)));s&&t.dropdown.setPanelsContent(s.element.textContent),t.dropdown.close()}}}const se=te,ie=class extends i{constructor(e){if(super(e),e){this.path=(e.getAttribute("data-path")||"").trim();const t=e.getAttribute("data-from");this.from=null===t?-1/0:Number(t),isNaN(this.from)&&(this.from=-1/0);const s=e.getAttribute("data-to");this.to=null===s?1/0:Number(s),isNaN(this.to)&&(this.to=1/0);const i=e.getAttribute("data-min");this.min=null===i?this.from:Number(i),isNaN(this.min)&&(this.min=this.from);const r=e.getAttribute("data-max");this.max=null===r?this.to:Number(r),isNaN(this.max)&&(this.max=this.to),this.or=e.getAttribute("data-or")||null}}getRangeFilterOptions(){return{path:this.path,min:this.min,from:this.from,to:this.to,max:this.max,or:this.or}}isEqualTo(e){return this.path===e.path&&this.from===e.from&&this.to===e.to&&this.min===e.min&&this.max===e.max}},re=class extends p{addControl(e){if(e.name!==this.name||e.group!==this.group)return null;const t=new ie(e.element);return this.controls.push(t),t}getRangeFilterOptions(){let e=[];for(let t of this.controls)e=e.concat(t.getRangeFilterOptions());return e}};class ne extends(G(re)){getRangeFilterOptions(){let e=[],t=this.getLastSelectedRadio();t&&(e=e.concat(t.getRangeFilterOptions()));for(let t of this.checkboxes)t.selected&&(e=e.concat(t.getRangeFilterOptions()));return e}}const oe=ne;class le{constructor(e,t=!1,s=0,i=0,r=0,n=0,o=((e,t)=>{})){if(e){if(this.element=e,this.element.classList.add("jplist-slider"),!this.element)return;this.isVertical=t,this.callback=o,this.min=s,this.max=n,t&&this.element.classList.add("jplist-slider-vertical"),this.handler1=document.createElement("span"),this.handler1.classList.add("jplist-slider-holder-1"),this.element.appendChild(this.handler1),this.range=document.createElement("span"),this.range.classList.add("jplist-slider-range"),this.element.appendChild(this.range),this.handler1.left=0,this.handler1.top=0,this.handler2=document.createElement("span"),this.handler2.classList.add("jplist-slider-holder-2"),this.element.appendChild(this.handler2),this.handler2.left=0,this.handler2.top=0,this.dragging=null,this.handler1.addEventListener("mousedown",this.start.bind(this)),this.handler2.addEventListener("mousedown",this.start.bind(this)),this.handler1.addEventListener("touchstart",this.start.bind(this)),this.handler2.addEventListener("touchstart",this.start.bind(this)),document.addEventListener("mousemove",this.render.bind(this)),document.addEventListener("touchmove",this.render.bind(this)),window.addEventListener("resize",this.resize.bind(this)),document.addEventListener("mouseup",this.stop.bind(this)),document.addEventListener("touchend",this.stop.bind(this)),document.body.addEventListener("mouseleave",this.stop.bind(this)),this.element.addEventListener("mousedown",this.jump.bind(this)),this.setValues(i,r)}}setValues(e,t,s=!0){t<e&&(t=e);const i=this.getInnerValue(e,this.min,this.max),r=this.getInnerValue(t,this.min,this.max);this.update({x:r,y:r},this.handler2,s),this.update({x:i,y:i},this.handler1,s)}getPreviewValue(e,t,s){const i=t,r=s;return(e-0)/(this.element.getBoundingClientRect()[this.isVertical?"height":"width"]-0)*(r-i)+i}getInnerValue(e,t,s){return(e-t)/(s-t)*(this.element.getBoundingClientRect()[this.isVertical?"height":"width"]-0)+0}jump(e){e.preventDefault();let t=this.getHandlerPos(e);this.isVertical?this.dragging=Math.abs(t.y-this.handler1.top)<Math.abs(t.y-this.handler2.top)?this.handler1:this.handler2:this.dragging=Math.abs(t.x-this.handler1.left)<Math.abs(t.x-this.handler2.left)?this.handler1:this.handler2,this.render(e)}setZIndex(){const e=window.getComputedStyle&&Number(document.defaultView.getComputedStyle(this.handler1,null).getPropertyValue("z-index"))||200,t=window.getComputedStyle&&Number(document.defaultView.getComputedStyle(this.handler2,null).getPropertyValue("z-index"))||200;if(e===t)this.dragging.style["z-index"]=e+1;else{const s=Math.max(e,t),i=Math.min(e,t);this.handler1.style["z-index"]=i,this.handler2.style["z-index"]=i,this.dragging.style["z-index"]=s}}start(e){e.preventDefault(),e.stopPropagation(),this.dragging=e.target,this.setZIndex(),this.render()}stop(e){this.dragging=null}resize(e){this.handler1&&this.handler2&&this.setValues(this.handler1.value,this.handler2.value)}render(e){e&&this.dragging&&this.update(this.getHandlerPos(e),this.dragging)}update(e,t,s=!0){if(t){const i=this.element.getBoundingClientRect(),r=this.isVertical?"height":"width",n=this.isVertical?"y":"x",o=this.isVertical?"top":"left";e[n]<0&&(e[n]=0),e[n]>i[r]&&(e[n]=i[r]),t===this.handler1&&e[n]>=this.handler2[o]&&(e[n]=this.handler2[o]),t===this.handler2&&e[n]<=this.handler1[o]&&(e[n]=this.handler1[o]),t[o]=e[n],t.value=this.getPreviewValue(e[n],this.min,this.max),t.style[o]=e[n]+"px",this.range.style[o]=this.handler1[o]+"px";const l=this.handler2[o]-this.handler1[o];this.range.style[r]=(l>=0?l:0)+"px",this.callback&&s&&this.callback(this.handler1.value,this.handler2.value)}}static sub(e,t){return{x:e.x-t.x,y:e.y-t.y}}getHandlerPos(e){const t=this.element.getBoundingClientRect(),s={x:e.touches&&e.touches.length>0?e.touches[0].pageX:e.clientX,y:e.touches&&e.touches.length>0?e.touches[0].pageY:e.clientY},i={x:t.left,y:t.top};return le.sub(s,i)}}const ae=le,de=class extends re{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t}addControl(e){const t=super.addControl(e),s=e.element.querySelector('[data-type="slider"]');if(t.val1Elements=e.element.querySelectorAll('[data-type="value-1"]'),t.val2Elements=e.element.querySelectorAll('[data-type="value-2"]'),t.minElements=e.element.querySelectorAll('[data-type="min"]'),t.maxElements=e.element.querySelectorAll('[data-type="max"]'),!s)return;const i=e.element.getAttribute("data-orientation")||"horizontal";for(let e of t.minElements)e.textContent=t.min;for(let e of t.maxElements)e.textContent=t.max;if(t.id){const e=this.deepLinkParams.find((e=>e.key===t.id));if(e&&e.value){const s=e.value.split("_");2===s.length&&(t.from=Number(s[0])||0,t.to=Number(s[1])||0)}}t.slider=new ae(s,"vertical"===i,t.min,t.from,t.to,t.max,((e,s)=>{for(let s of t.val1Elements)s.textContent=Math.round(e);for(let e of t.val2Elements)e.textContent=Math.round(s);for(let t of this.controls)t.slider&&t.slider.setValues(e,s,!1);window.jplist&&window.jplist.refresh(this.group,t)}))}getRangeFilterOptions(){let e=[];for(let t of this.controls){if(!t.slider||!t.slider.handler1||!t.slider.handler2)continue;const s=t.getRangeFilterOptions();s.from=t.slider.handler1.value,s.to=t.slider.handler2.value,e=e.concat(s)}return e}getDeepLink(){const e=this.controls.map((e=>e.id&&e.slider&&e.slider.handler1&&e.slider.handler2?e.id+"="+e.slider.handler1.value+"_"+e.slider.handler2.value:"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}},he=class extends p{addControl(e){super.addControl(e),e.element.addEventListener("jplist.state",(t=>{if(!t.jplistState)return;const s=Number(t.jplistState.itemsNumber)||0;e.element.style.display=0===s?"":"none"}),!1)}},ce="jplist-selected";class ue extends p{constructor(e,t,s=[],i=null){super(e,t,s,i),this.group=e,this.name=t,this.classNames=new Set,this.selectedClassName=""}addControl(e){if(super.addControl(e),e.groupClassName=e.element.getAttribute("data-class")||"",e.selected="true"===e.element.getAttribute("data-selected"),e.id){const t=this.deepLinkParams.find((t=>t.key===e.id));t&&(e.selected="1"===t.value)}this.classNames.add(e.groupClassName),e.element.addEventListener("click",(t=>{t.preventDefault(),this.handleSelectedControls(e.groupClassName),this.handleClasses(),window.jplist&&window.jplist.refresh(this.group,e)}),!1),this.handleClasses()}handleClasses(){const e=document.querySelectorAll('[data-jplist-group="'+this.group+'"]');this.resetAllGroups(e);let t=this.getLatestSelectedControl();t&&(this.handleSelectedControls(t.groupClassName),ue.addClassToGroups(t.groupClassName,e))}getLatestSelectedControl(){let e=null;for(let t of this.controls)t.selected&&(e=t);return!e&&this.controls.length>0&&(e=this.controls[0]),e}resetAllGroups(e){for(let t of e)for(let e of this.classNames)t.classList.remove(e)}handleSelectedControls(e){for(let t of this.controls)t.groupClassName===e?(t.selected=!0,t.element.classList.add(ce)):(t.selected=!1,t.element.classList.remove(ce))}static addClassToGroups(e,t){for(let s of t)s.classList.add(e)}getDeepLink(){const e=this.controls.map((e=>e.id?e.selected?e.id+"=1":e.id+"=0":"")).filter((e=>""!==e));return Array.from(new Set(e)).join("&")}}const pe=ue,me=class extends p{addControl(e){super.addControl(e),e.element.addEventListener("click",(t=>{t.preventDefault(),window.jplist&&window.jplist.resetControls(this.group,e)}),!1)}};class ge extends p{static getDynamicCounterValue(e,t,s){return(s=ge.getFilteredItems(e,t,s)).length}static getStaticCounterValue(e,t,s){let i=0;for(let r of s){let s=r.items;s=ge.getFilteredItems(e,t,s),i+=s.length}return i}static getFilteredItems(e,t,s){switch(t){case"text":s=d.textFilter(s,e.text,e.path,e.mode,e.regex);break;case"path":s=d.pathFilter(s,e.path,e.isInverted);break;case"range":s=d.rangeFilter(s,e.path,e.from,e.to,e.min,e.max)}return s}render(e){for(let t of this.controls)t.element.innerHTML=t.format.replace("{count}",e)}addControl(e){super.addControl(e),e.filterType=e.element.getAttribute("data-filter-type")||"path",e.format=e.element.getAttribute("data-format")||"{count}",e.mode=e.element.getAttribute("data-mode")||"dynamic";let t=null;switch(e.filterType){case"text":t=new F(e.element);break;case"path":t=new _(e.element);break;case"range":t=new ie(e.element)}e.element.addEventListener("jplist.state",(s=>{if(!t||!s.jplistState)return;let i=0;if("static"===e.mode&&s.jplistState.groups&&s.jplistState.groups.has(e.group)){const r=s.jplistState.groups.get(e.group);i=ge.getStaticCounterValue(t,e.filterType,r)}"dynamic"===e.mode&&s.jplistState.filtered&&s.jplistState.filtered.length>0&&(i=ge.getDynamicCounterValue(t,e.filterType,s.jplistState.filtered)),this.render(i)}),!1)}}const fe=ge;(()=>{if("function"!=typeof window.CustomEvent){const e=(e,t)=>{t=t||{bubbles:!1,cancelable:!1,detail:void 0};var s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),s};e.prototype=window.Event.prototype,window.CustomEvent=e}window.jplist=window.jplist||{},window.jplist.controlTypes=window.jplist.controlTypes||new Map([["hidden-sort",f],["sort-buttons",x],["radio-buttons-sort",C],["checkbox-sort",y],["select-sort",L],["dropdown-sort",S],["pagination",E],["textbox-filter",T],["checkbox-text-filter",q],["radio-buttons-text-filter",V],["buttons-text-filter",U],["select-filter",X],["dropdown-filter",se],["checkbox-path-filter",$],["radio-buttons-path-filter",K],["buttons-path-filter",ee],["buttons-range-filter",oe],["slider-range-filter",de],["no-results",he],["dropdown",P],["layout",pe],["reset",me],["counter",fe]]);let e=new u;window.jplist.init=e.init.bind(e),window.jplist.refresh=e.refresh.bind(e),window.jplist.resetControls=e.resetControls.bind(e),window.jplist.resetControl=e.resetControl.bind(e),window.jplist.resetContent=e.resetContent.bind(e)})()})();
//# sourceMappingURL=jplist-es6.min.js.map